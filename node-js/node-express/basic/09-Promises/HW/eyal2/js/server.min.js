"use strict";var _express=_interopRequireDefault(require("express")),_bodyParser=require("body-parser"),_cookieParser=_interopRequireDefault(require("cookie-parser")),_nodeFetch=_interopRequireDefault(require("node-fetch")),_urlEncodeDecode=require("url-encode-decode");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var app=(0,_express.default)(),port=process.env.PORT||3e3;function detectLang(n){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap((0,_nodeFetch.default)("https://google-translate1.p.rapidapi.com/language/translate/v2/detect",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded","accept-encoding":"application/gzip","x-rapidapi-key":"2dae7de7a8msh9ca6fa97f167561p1494d2jsn956ba9663ea0","x-rapidapi-host":"google-translate1.p.rapidapi.com"},body:{q:"".concat(n)}}).then(function(e){t=e}).then(function(e){return e.json({response:e})}).catch(function(e){console.error(e)}));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}})}function GetLangFromAPI(){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap((0,_nodeFetch.default)("https://ws.detectlanguage.com/0.2/languages").then(function(e){return e.json({response:e})}).then(function(e){n=e,console.log("ok",e)}).catch(function(e){console.error(e)}));case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}})}app.use((0,_cookieParser.default)()),app.use((0,_bodyParser.json)()),app.use("public"),app.get("/getLang",function(e,n){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("in the getLang"),e.next=3,regeneratorRuntime.awrap(GetLangFromAPI());case 3:t=e.sent,n.send(t);case 5:case"end":return e.stop()}})}),app.post("/SendTranslation",function(n,t){var r,a,o,c,s,u;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(detectLang(n.body.message));case 2:return r=e.sent,console.log("detectLang: ".concat(r)),e.prev=4,a=n.body,o=a.fromLang,c=a.toLang,s=a.message,e.next=8,regeneratorRuntime.awrap(translate(o,c,s));case 8:u=e.sent,t.send({transaction:u}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),console.log(e.t0);case 15:case"end":return e.stop()}},null,null,[[4,12]])});var translate=function(n,t,r){var a,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(0,_urlEncodeDecode.encode)(r),e.next=3,regeneratorRuntime.awrap((0,_nodeFetch.default)("https://translated-mymemory---translation-memory.p.rapidapi.com/api/get?langpair=".concat(n,"%7C").concat(t,"&q=").concat(o,"&mt=1&onlyprivate=1&de=a%40b.c"),{method:"GET",headers:{"x-rapidapi-key":"2dae7de7a8msh9ca6fa97f167561p1494d2jsn956ba9663ea0","x-rapidapi-host":"translated-mymemory---translation-memory.p.rapidapi.com"}}).then(function(e){return e.json({response:e})}).then(function(e){a=e.responseData.translatedText}).catch(function(e){console.error(e)}));case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}})};app.listen(port,function(){console.log("Listen on port ".concat(port))});
//# sourceMappingURL=server.min.js.map
